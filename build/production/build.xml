<?xml version="1.0" encoding="UTF-8" ?>
<project name="php3" default="build" basedir=".">

    <target name="vars">
	<php returnProperty="datetime" function="date">
            <param value="Y-m-d-H-i-s" />
    </php>
        <resolvepath propertyName="target.dir" path="/home/domains/mayarossa/${datetime}" />
        <property name="domain" value="mayarossa.ru"/>
        <echo msg="this is target.dir - ${target.dir}" />
		<echo msg="this is project.basedir - ${project.basedir}" />
    </target>

    <target name="copy">
        <copy todir="${target.dir}" overwrite="true">
            <fileset dir="${project.basedir}" >
                <include name="**" />
            </fileset>
        </copy>
    </target>
	
	<target name="config">
	<echo msg="${domain}" />
        <copy file="${project.basedir}\config\params.php" tofile="${target.dir}\config\params.php"
              overwrite="true">
			  
            <filterchain>
                <replacetokens begintoken="{{" endtoken="}}">
                    <token key="domain" value="${domain}"/>
                </replacetokens>
            </filterchain>
        </copy>
    </target>
	
	   <target name="composer">
        <exec command="php C:\OpenServer\composer\composer.phar install" dir="${target.dir}" checkreturn="true" returnProperty="exec.return" outputProperty="exec.output"/>
    </target>
	
	<target name="symlink">
        <symlink target="${target.dir}" link="C:\OpenServer\composer\test" overwrite="true" />
    </target>

    <target name="build" depends="vars" />

</project>
